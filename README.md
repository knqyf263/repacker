# repacker
Automate the creation of methods that copy from src struct to target struct

## Usage

### Basic Usage
Two structs that have the same field.

```
$ cat foo/foo.go
package foo

type Foo struct {
        ID     int
        Name   string
        Detail string
}

$ cat bar/bar.go
package bar

type Bar struct {
        ID     int
        Name   string
        Detail string
}
```

Excecute repacker.
```
$ repacker -dsttype=Foo -srcdir=bar -srctype=Bar foo
```

Automatically creates a method that copy from `Bar` to `Foo`.

```
$ cat foo/foo_repack.go 
// Code generated by "repacker -dsttype=Foo -srcdir=bar -srctype=Bar foo"; DO NOT EDIT

package foo

import (
        "fmt"

        "github.com/knqyf263/repacker_test/bar"
)

// NewFoo creates Foo from bar.Bar
func NewFoo(s *bar.Bar) *Foo {
        return &Foo{
                ID:     s.ID,
                Name:   s.Name,
                Detail: s.Detail,
        }
}
```

### Struct tag
Add the same struct tag to the fields you want to copy

```
$ cat foo/foo.go
package foo

type Foo struct {
        ID   int
        Name string
        Foo  string `repack:"foo"`
}

$ cat bar/bar.go
package bar

type Bar struct {
        ID   int
        Name string
        Bar  string `repack:"foo"`
}
```


```
$ cat foo/foo_repack.go 
// Code generated by "repacker -dsttype=Foo -srcdir=bar -srctype=Bar foo"; DO NOT EDIT

package foo

import (
        "fmt"

        "github.com/knqyf263/repacker_test/bar"
)

// NewFoo creates Foo from bar.Bar
func NewFoo(s *bar.Bar) *Foo {
        return &Foo{
                ID:   s.ID,
                Name: s.Name,
                Foo:  s.Bar,
        }
}
```

### Different Type

```
$ cat foo/foo.go
package foo

type Foo struct {
        ID        int
        Name      string
        CreatedAt string
}

$ cat bar/bar.go
package bar

import "time"

type Bar struct {
        ID   int
        Name string
        CreatedAt time.Time
}
```

```
$ cat foo/foo_repack.go 
// Code generated by "repacker -dsttype=Foo -srcdir=bar -srctype=Bar foo"; DO NOT EDIT

package foo

import (
        "fmt"

        "github.com/knqyf263/repacker_test/bar"
)

// NewFoo creates Foo from bar.Bar
func NewFoo(s *bar.Bar) *Foo {
        return &Foo{
                ID:        s.ID,
                Name:      s.Name,
                CreatedAt: fmt.Sprintf(s.CreatedAt),
        }
}
```

### go generate

```
$ cat foo/foo.go
package foo

//go:generate repacker -dsttype=Foo -srcdir=../bar -srctype=Bar

type Foo struct {
        ID   int
        Name string
        Foo  string `repack:"foo"`
}
```

**CAUTION: Specify a relative path**

```
$ go generate
```